(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51f5b8d5"],{"163b":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("7f7f"),a("ac6a");var o=a("2b0e"),r=function(e){return o["default"]._.mapValues(e,(function(e){return e||void 0}))}},"2e81":function(e,t,a){t=e.exports=a("2350")(!1),t.push([e.i,"",""])},"5c1f":function(e,t,a){var o=a("65ea");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var r=a("2fb2").default;r("0b87fb46",o,!0,{})},"65ea":function(e,t,a){t=e.exports=a("2350")(!1),t.push([e.i,"",""])},"6e0c":function(e,t,a){t=e.exports=a("2350")(!1),t.push([e.i,"",""])},"80c8":function(e,t,a){var o=a("6e0c");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var r=a("2fb2").default;r("3aa0950e",o,!0,{})},d8a6:function(e,t,a){"use strict";a.r(t);var o=a("b775");function r(e){return Object(o["a"])({url:"/user",method:"get",params:e})}function s(e){return Object(o["a"])({url:"/user/store",method:"post",data:e})}function i(e){return Object(o["a"])({url:"/user/enable/".concat(e),method:"post"})}function n(e){return Object(o["a"])({url:"/user/disable/".concat(e),method:"post"})}function l(e){return Object(o["a"])({url:"/user/remove/".concat(e),method:"post"})}function c(e,t){return Object(o["a"])({url:"user/editPassword/".concat(t.id),method:"post",data:t})}var u=a("163b"),d=(a("7f7f"),{name:"AddUser",props:{open:{type:Boolean,default:!1,required:!0},type:{required:!0,default:"add",type:String},formData:{required:!0,default:function(){},type:Object}},data:function(){return{title:"新增",form:{id:"",account:"",name:"",email:"",is_admin:0,password:"",confirm_password:"",status:1},formRules:{account:[{required:!0,message:"请输入用户名",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],email:[{type:"email",required:!0,message:"请输入有效邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],confirm_password:[{required:!0,message:"请再次输入密码",trigger:"blur"}]}}},created:function(){},mounted:function(){},methods:{submit:function(){var e=this;this.$refs["form"].validate((function(t){t&&s(e.form).then((function(){e.$emit("reload"),e.onClose()}))}))},onClose:function(){this.form={id:"",account:"",name:"",email:"",is_admin:0,password:"",confirm_password:"",status:1},this.$refs["form"].resetFields(),this.$emit("update:open",!1)}},filters:{},watch:{open:function(e){e&&"edit"===this.type&&(this.title="编辑",this.form.id=this.formData.id,this.form.account=this.formData.account,this.form.name=this.formData.name,this.form.email=this.formData.email,this.form.is_admin=this.formData.is_admin,this.form.status=this.formData.status)}}}),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"drag-move",rawName:"v-drag-move"}],staticClass:"task-log",attrs:{title:e.title+"用户",visible:e.open,"before-close":e.onClose,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"600px"}},[[a("el-form",{ref:"form",attrs:{model:e.form,size:"mini",rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"账号",prop:"account"}},[a("el-input",{model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),e.form.id?e._e():[a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"confirm_password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.form.confirm_password,callback:function(t){e.$set(e.form,"confirm_password",t)},expression:"form.confirm_password"}})],1)],e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"is_admin"}},[a("el-radio-group",{model:{value:e.form.is_admin,callback:function(t){e.$set(e.form,"is_admin",t)},expression:"form.is_admin"}},[a("el-radio",{attrs:{label:0}},[e._v("普通用户")]),e._v(" "),a("el-radio",{attrs:{label:1}},[e._v("管理员")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-radio",{attrs:{label:1}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("禁用")])],1)],1)],2)],e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.onClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],2)},m=[],p=a("2455");function b(e){a("80c8")}var v=!1,_=b,h="data-v-2e799f36",w=null,g=Object(p["a"])(d,f,m,v,_,h,w),y=g.exports,k={name:"EditPassword",props:{open:{type:Boolean,default:!1,required:!0},formData:{required:!0,default:function(){},type:Object}},data:function(){return{form:{id:"",new_password:"",confirm_new_password:""},formRules:{new_password:[{required:!0,message:"请输入新密码",trigger:"blur"}],confirm_new_password:[{required:!0,message:"请再次输入新密码",trigger:"blur"}]}}},created:function(){},mounted:function(){},methods:{submit:function(){var e=this;this.$refs["form"].validate((function(t){t&&c(e.form.id,e.form).then((function(){e.$emit("reload"),e.onClose()}))}))},onClose:function(){this.form={id:"",new_password:"",confirm_new_password:""},this.$refs["form"].resetFields(),this.$emit("update:open",!1)}},filters:{},watch:{open:function(e){e&&(this.form.id=this.formData.id)}}},x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"drag-move",rawName:"v-drag-move"}],staticClass:"task-log",attrs:{title:"修改密码",visible:e.open,"before-close":e.onClose,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"600px"}},[[a("el-form",{ref:"form",attrs:{model:e.form,size:"mini",rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"新密码",prop:"new_password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.form.new_password,callback:function(t){e.$set(e.form,"new_password",t)},expression:"form.new_password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认新密码",prop:"confirm_new_password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.form.confirm_new_password,callback:function(t){e.$set(e.form,"confirm_new_password",t)},expression:"form.confirm_new_password"}})],1)],1)],e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.onClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],2)},D=[];function $(e){a("f3b3")}var C=!1,O=$,z="data-v-238ebadb",L=null,j=Object(p["a"])(k,x,D,C,O,z,L),q=j.exports,S={name:"List",components:{addUser:y,editPassword:q},data:function(){return{newDate:(new Date).getTime(),listData:[],listLoading:!1,users:[],userTotal:0,listQuery:{page_size:20,page:1},isAdmin:JSON.parse(localStorage.getItem("userInfo")).is_admin,addUserOption:{open:!1,formData:{},type:"add"},editPasswordOption:{open:!1,formData:{}},total:0}},created:function(){this.renderList()},mounted:function(){},methods:{handleEditPassword:function(e){this.editPasswordOption={open:!0,formData:e}},openUserDialog:function(e,t){this.addUserOption={open:!0,type:e,formData:t}},changeStatus:function(e){e.status?i(e.id).then((function(){e.status=1})):n(e.id).then((function(){e.status=0}))},formatRole:function(e,t){return 1===e[t.property]?"管理员":"普通用户"},renderList:function(){var e=this;this.listLoading=!0;var t=Object(u["a"])(this.listQuery);r(t).then((function(t){var a=t.data.data;e.total=t.data.total;var o=e._.cloneDeep(a);e.listData=[],e.listData=o,document.querySelector(".el-table__body-wrapper").scrollTop=0,e.listLoading=!1,e.$refs["table"].doLayout()})).catch((function(){e.listLoading=!1}))},remove:function(e){var t=this;this.$confirm("确认要删除此用户吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l(e.id),t.renderList()})).catch((function(){}))},handleSizeChange:function(e){this.listQuery.page=1,this.listQuery.page_size=e,this.renderList()},handleCurrentChange:function(e){this.listQuery.page=e,this.renderList()}},filters:{},watch:{}},P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"header-box"},[a("el-row",{staticClass:"right-row"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.openUserDialog("add",{})}}},[e._v("新增")])],1)],1),e._v(" "),a("div",{staticClass:"content-box"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading.lock",value:e.listLoading,expression:"listLoading",modifiers:{lock:!0}}],key:e.newDate,ref:"table",staticStyle:{width:"100%"},attrs:{data:e.listData,"element-loading-text":"努力加载中",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"用户id"}}),e._v(" "),a("el-table-column",{attrs:{prop:"account",label:"账号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),e._v(" "),a("el-table-column",{attrs:{prop:"is_admin",formatter:e.formatRole,label:"角色"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-value":1,"inactive-vlaue":0,"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(a){return e.changeStatus(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}})]}}])}),e._v(" "),this.isAdmin?a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.openUserDialog("edit",t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){return e.handleEditPassword(t.row)}}},[e._v("修改密码")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.remove(t.row)}}},[e._v("删除")])]}}],null,!1,1329918089)}):e._e()],1),e._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",small:"","current-page":e.listQuery.page,"page-sizes":[20,50,100,200],"page-size":e.listQuery.page_size,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("add-user",e._b({on:{reload:e.renderList}},"add-user",e.addUserOption,!1,!0)),e._v(" "),a("edit-password",e._b({on:{reload:e.renderList}},"edit-password",e.editPasswordOption,!1,!0))],1)},U=[];function Q(e){a("5c1f")}var E=!1,R=Q,T="data-v-0b1e07fa",B=null,N=Object(p["a"])(S,P,U,E,R,T,B);t["default"]=N.exports},f3b3:function(e,t,a){var o=a("2e81");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var r=a("2fb2").default;r("66704d5e",o,!0,{})}}]);