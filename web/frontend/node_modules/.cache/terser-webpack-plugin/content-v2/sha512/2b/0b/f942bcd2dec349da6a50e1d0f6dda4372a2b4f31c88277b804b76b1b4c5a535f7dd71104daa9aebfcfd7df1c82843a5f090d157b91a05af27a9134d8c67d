{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-7d036668\"],{\"163b\":function(t,e,a){\"use strict\";a.d(e,\"a\",(function(){return i}));a(\"7f7f\"),a(\"ac6a\");var r=a(\"2b0e\"),i=function(t){return r[\"default\"]._.mapValues(t,(function(t){return t||void 0}))}},\"4b2a\":function(t,e,a){e=t.exports=a(\"2350\")(!1),e.push([t.i,\"\",\"\"])},7385:function(t,e,a){\"use strict\";a.r(e);var r=a(\"b775\");function i(t){return Object(r[\"a\"])({url:\"/host\",method:\"get\",params:t})}function o(t){return Object(r[\"a\"])({url:\"/host/store\",method:\"post\",data:t})}function n(t){return Object(r[\"a\"])({url:\"/host/remove/\".concat(t),method:\"post\"})}function s(t){return Object(r[\"a\"])({url:\"host/ping/\".concat(t),method:\"get\"})}var l=a(\"163b\"),c=(a(\"7f7f\"),{name:\"AddHost\",props:{open:{type:Boolean,default:!1,required:!0},type:{required:!0,default:\"add\",type:String},formData:{required:!0,default:function(){},type:Object}},data:function(){return{title:\"新增\",form:{id:\"\",name:\"\",port:5921,alias:\"\",remark:\"\"},formRules:{name:[{required:!0,message:\"请输入主机名\",trigger:\"blur\"}],port:[{required:!0,message:\"请输入端口\",trigger:\"blur\"},{type:\"number\",message:\"端口无效\"}],alias:[{required:!0,message:\"请输入节点名称\",trigger:\"blur\"}]}}},created:function(){},mounted:function(){},methods:{submit:function(){var t=this;this.$refs[\"form\"].validate((function(e){e&&o(t.form).then((function(){t.$emit(\"reload\"),t.onClose()}))}))},onClose:function(){this.form={id:\"\",name:\"\",port:5921,alias:\"\",remark:\"\"},this.$refs[\"form\"].resetFields(),this.$emit(\"update:open\",!1)}},filters:{},watch:{open:function(t){t&&\"edit\"===this.type&&(this.title=\"编辑\",this.form.id=this.formData.id,this.form.name=this.formData.name,this.form.port=this.formData.port,this.form.alias=this.formData.alias,this.form.remark=this.formData.remark)}}}),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"el-dialog\",{directives:[{name:\"drag-move\",rawName:\"v-drag-move\"}],staticClass:\"task-log\",attrs:{title:t.title+\"任务节点\",visible:t.open,\"before-close\":t.onClose,\"close-on-click-modal\":!1,\"close-on-press-escape\":!1,width:\"600px\"}},[[a(\"el-form\",{ref:\"form\",attrs:{model:t.form,size:\"mini\",rules:t.formRules,\"label-width\":\"100px\"}},[a(\"el-form-item\",{attrs:{label:\"节点名称\",prop:\"alias\"}},[a(\"el-input\",{model:{value:t.form.alias,callback:function(e){t.$set(t.form,\"alias\",e)},expression:\"form.alias\"}})],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"主机名\",prop:\"name\"}},[a(\"el-input\",{model:{value:t.form.name,callback:function(e){t.$set(t.form,\"name\",e)},expression:\"form.name\"}})],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"端口\",prop:\"port\"}},[a(\"el-input\",{model:{value:t.form.port,callback:function(e){t.$set(t.form,\"port\",t._n(e))},expression:\"form.port\"}})],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"备注\"}},[a(\"el-input\",{attrs:{type:\"textarea\",rows:5,size:\"medium\",width:\"100\"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,\"remark\",e)},expression:\"form.remark\"}})],1)],1)],t._v(\" \"),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{on:{click:t.onClose}},[t._v(\"取 消\")]),t._v(\" \"),a(\"el-button\",{attrs:{type:\"primary\"},on:{click:t.submit}},[t._v(\"确 定\")])],1)],2)},m=[],d=a(\"2455\");function f(t){a(\"89c9\")}var p=!1,h=f,v=\"data-v-39aba8f3\",b=null,g=Object(d[\"a\"])(c,u,m,p,h,v,b),y=g.exports,_={name:\"HostList\",components:{addHost:y},data:function(){return{newDate:(new Date).getTime(),listData:[],listLoading:!1,isAdmin:JSON.parse(localStorage.getItem(\"userInfo\")).is_admin,hosts:[],total:0,listQuery:{page_size:20,page:1,id:\"\",name:\"\",alias:\"\"},addHostOptions:{open:!1,type:\"add\",formData:{}}}},created:function(){this.renderList()},mounted:function(){},methods:{toTasks:function(t){this.$router.push(\"/task/manager/timing-tasks?host_id=\".concat(t))},testLink:function(t){var e=this;s(t).then((function(t){e.$message.success(t.message)}))},removeHost:function(t){var e=this;this.$confirm(\"确认要删除任务节点吗？\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then((function(){n(t.id).then((function(){e.renderList()}))})).catch((function(){}))},openHostDialog:function(t,e){this.addHostOptions={open:!0,type:t,formData:e}},renderList:function(){var t=this;this.listLoading=!0;var e=Object(l[\"a\"])(this.listQuery);i(e).then((function(e){var a=e.data.data;t.total=e.data.total;var r=t._.cloneDeep(a);t.listData=[],t.listData=r,document.querySelector(\".el-table__body-wrapper\").scrollTop=0,t.listLoading=!1,t.$refs[\"table\"].doLayout()})).catch((function(){t.listLoading=!1}))},handleFilter:function(){this.newDate=(new Date).getTime(),this.listQuery.page=1,this.renderList()},handleSizeChange:function(t){this.listQuery.page=1,this.listQuery.page_size=t,this.renderList()},handleCurrentChange:function(t){this.listQuery.page=t,this.renderList()},clearSearch:function(){this.$refs.listQuery.resetFields(),this.newDate=(new Date).getTime(),this.renderList()}},filters:{},watch:{}},k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"div\",{staticClass:\"header-box\"},[a(\"el-form\",{ref:\"listQuery\",staticClass:\"advt-form-inline\",attrs:{inline:!0,model:t.listQuery,size:\"mini\"}},[a(\"el-form-item\",{attrs:{label:\"节点ID\",prop:\"id\"}},[a(\"el-input\",{attrs:{clearable:\"\",placeholder:\"请输入节点ID\"},model:{value:t.listQuery.id,callback:function(e){t.$set(t.listQuery,\"id\",\"string\"===typeof e?e.trim():e)},expression:\"listQuery.id\"}})],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"主机名\",prop:\"name\"}},[a(\"el-input\",{attrs:{clearable:\"\",placeholder:\"请输入主机名\"},model:{value:t.listQuery.name,callback:function(e){t.$set(t.listQuery,\"name\",\"string\"===typeof e?e.trim():e)},expression:\"listQuery.name\"}})],1),t._v(\" \"),a(\"el-form-item\",[a(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce:listQuery\",value:t.handleFilter,expression:\"handleFilter\",arg:\"listQuery\"}],attrs:{\"data-type\":\"search\",type:\"primary\"}},[t._v(\"搜索\")]),t._v(\" \"),a(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce:listQuery\",value:t.clearSearch,expression:\"clearSearch\",arg:\"listQuery\"}],attrs:{\"data-type\":\"clear\"}},[t._v(\"清空\")])],1)],1),t._v(\" \"),a(\"el-row\",{staticClass:\"right-row\"},[a(\"el-button\",{attrs:{type:\"primary\",size:\"mini\"},on:{click:function(e){return t.openHostDialog(\"add\",{})}}},[t._v(\"新增\")])],1)],1),t._v(\" \"),a(\"div\",{staticClass:\"content-box\"},[a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading.lock\",value:t.listLoading,expression:\"listLoading\",modifiers:{lock:!0}}],key:t.newDate,ref:\"table\",staticStyle:{width:\"100%\"},attrs:{data:t.listData,\"element-loading-text\":\"努力加载中\",border:\"\"}},[a(\"el-table-column\",{attrs:{prop:\"id\",width:\"100\",label:\"节点ID\"}}),t._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"alias\",label:\"节点名称\"}}),t._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"name\",label:\"主机名\"}}),t._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"port\",width:\"100\",label:\"端口\"}}),t._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"remark\",label:\"备注\"}}),t._v(\" \"),t.isAdmin?a(\"el-table-column\",{attrs:{label:\"操作\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[a(\"el-button\",{attrs:{size:\"mini\",type:\"primary\"},on:{click:function(a){return t.openHostDialog(\"edit\",e.row)}}},[t._v(\"编辑\")]),t._v(\" \"),a(\"el-button\",{attrs:{size:\"mini\",type:\"success\"},on:{click:function(a){return t.toTasks(e.row.id)}}},[t._v(\"查看任务\")]),t._v(\" \"),a(\"el-button\",{attrs:{size:\"mini\",type:\"info\"},on:{click:function(a){return t.testLink(e.row.id)}}},[t._v(\"测试连接\")]),t._v(\" \"),a(\"el-button\",{attrs:{size:\"mini\",type:\"danger\"},on:{click:function(a){return t.removeHost(e.row)}}},[t._v(\"删除\")])]}}],null,!1,3741859649)}):t._e()],1),t._v(\" \"),a(\"div\",{staticClass:\"pagination-container\"},[a(\"el-pagination\",{attrs:{background:\"\",layout:\"total, sizes, prev, pager, next, jumper\",small:\"\",\"current-page\":t.listQuery.page,\"page-sizes\":[20,50,100,200],\"page-size\":t.listQuery.page_size,total:t.total},on:{\"size-change\":t.handleSizeChange,\"current-change\":t.handleCurrentChange}})],1)],1),t._v(\" \"),a(\"add-host\",t._b({on:{reload:t.renderList}},\"add-host\",t.addHostOptions,!1,!0))],1)},w=[];function D(t){a(\"feb5\")}var x=!1,Q=D,L=\"data-v-dba934fc\",z=null,C=Object(d[\"a\"])(_,k,w,x,Q,L,z);e[\"default\"]=C.exports},\"89c9\":function(t,e,a){var r=a(\"9e6d\");\"string\"===typeof r&&(r=[[t.i,r,\"\"]]),r.locals&&(t.exports=r.locals);var i=a(\"2fb2\").default;i(\"7c532e45\",r,!0,{})},\"9e6d\":function(t,e,a){e=t.exports=a(\"2350\")(!1),e.push([t.i,\"\",\"\"])},feb5:function(t,e,a){var r=a(\"4b2a\");\"string\"===typeof r&&(r=[[t.i,r,\"\"]]),r.locals&&(t.exports=r.locals);var i=a(\"2fb2\").default;i(\"6a9dc4ef\",r,!0,{})}}]);","extractedComments":[]}