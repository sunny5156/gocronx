{"remainingRequest":"/root/go/src/github.com/sunny5156/gocronx/web/new-theme/node_modules/thread-loader/dist/cjs.js!/root/go/src/github.com/sunny5156/gocronx/web/new-theme/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/root/go/src/github.com/sunny5156/gocronx/web/new-theme/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/root/go/src/github.com/sunny5156/gocronx/web/new-theme/src/store/modules/permission.js","dependencies":[{"path":"/root/go/src/github.com/sunny5156/gocronx/web/new-theme/src/store/modules/permission.js","mtime":1600240058000},{"path":"/root/go/src/github.com/sunny5156/gocronx/web/new-theme/node_modules/cache-loader/dist/cjs.js","mtime":1600257155902},{"path":"/root/go/src/github.com/sunny5156/gocronx/web/new-theme/node_modules/thread-loader/dist/cjs.js","mtime":1600257158773},{"path":"/root/go/src/github.com/sunny5156/gocronx/web/new-theme/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":1600257116664},{"path":"/root/go/src/github.com/sunny5156/gocronx/web/new-theme/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1600257145698}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport Vue from 'vue';\nimport { asyncRouterMap, constantRouterMap } from '@/router';\n/**\r\n * 通过meta.role判断是否与当前用户权限匹配\r\n * @param permissions\r\n * @param route\r\n */\n\nfunction hasPermission(permissions, route) {\n  var whiteList = ['notFound'];\n\n  if (route.name && Vue._.indexOf(whiteList, route.name) !== -1) {\n    return true;\n  }\n\n  if (route.meta && route.meta.permission) {\n    return Vue._.some(permissions, {\n      'tag': route.meta.permission,\n      'enable': true\n    });\n  } else {\n    return false;\n  }\n}\n/**\r\n * 递归过滤异步路由表，返回符合用户角色权限的路由表\r\n * @param asyncRouterMap\r\n * @param permissions\r\n */\n\n\nfunction filterAsyncRouter(asyncRouterMap, permissions) {\n  var accessedRouters = asyncRouterMap.filter(function (route) {\n    if (hasPermission(permissions, route)) {\n      if (route.children && route.children.length) {\n        route.children = filterAsyncRouter(route.children, permissions);\n      }\n\n      return true;\n    }\n\n    return false;\n  });\n  return accessedRouters;\n}\n\nvar permission = {\n  state: {\n    routers: constantRouterMap,\n    addRouters: []\n  },\n  mutations: {\n    SET_ROUTERS: function SET_ROUTERS(state, routers) {\n      state.addRouters = routers;\n      state.routers = constantRouterMap.concat(routers);\n    }\n  },\n  actions: {\n    GenerateRoutes: function GenerateRoutes(_ref, data) {\n      var commit = _ref.commit;\n      return new Promise(function (resolve) {\n        var permissions = data.permissions;\n        var accessedRouters = filterAsyncRouter(asyncRouterMap, permissions);\n        commit('SET_ROUTERS', accessedRouters);\n        resolve();\n      });\n    }\n  }\n};\nexport default permission;",null]}